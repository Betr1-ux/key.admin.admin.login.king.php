<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>مولد أكواد (UUID v4)</title>
  <style>
    :root { --bg:#0f1218; --card:#161b22; --muted:#9fb0c3; --text:#eaeef5; --border:#283142; }
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--text)}
    .wrap{max-width:900px;margin:0 auto;padding:24px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px;margin-bottom:16px;box-shadow:0 6px 20px rgba(0,0,0,.25)}
    h1,h2{margin:0 0 12px} p{margin:8px 0}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    input,button,select{padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:#0d1117;color:var(--text)}
    input[type="number"]{width:140px} button{cursor:pointer}
    textarea{width:100%;min-height:240px;border-radius:12px;border:1px solid var(--border);background:#0d1117;color:var(--text);padding:12px}
    .muted{color:var(--muted);font-size:.95em}
    .badge{display:inline-block;background:#0d1117;border:1px dashed var(--border);padding:4px 8px;border-radius:999px;font-size:.85em}
    code{background:#0d1117;border:1px solid var(--border);padding:2px 6px;border-radius:6px}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>مولّد أكواد (UUID v4)</h1>
    <p class="muted">ينتج أكواد بالشكل: <code>xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx</code> مثل أمثلتك.</p>

    <div class="card">
      <h2>إعدادات التوليد</h2>
      <div class="row">
        <label>عدد الأكواد:
          <input id="count" type="number" value="10" min="1" max="10000" />
        </label>
        <label>بادئة (اختياري):
          <input id="prefix" type="text" placeholder="مثال: VIP" />
        </label>
        <button id="btnGen">توليد</button>
        <span class="badge" id="status">جاهز</span>
      </div>
      <p class="muted">ملاحظة: التوليد يتم محليًا في المتصفح بدون إنترنت.</p>
    </div>

    <div class="card">
      <h2>النتائج</h2>
      <div class="row" style="margin-bottom:8px">
        <button id="btnCopy">نسخ الكل</button>
        <button id="btnDownload">تحميل TXT</button>
        <button id="btnClear">تفريغ</button>
        <span class="muted">إجمالي: <span id="total">0</span></span>
      </div>
      <textarea id="out" spellcheck="false" placeholder="ستظهر الأكواد هنا..."></textarea>
    </div>

    <div class="card">
      <h2>تحقق سريع من الصيغة</h2>
      <div class="row">
        <input id="checkInput" type="text" placeholder="ألصقي كود هنا للتحقق من شكله" style="flex:1" />
        <button id="btnCheck">تحقق</button>
      </div>
      <p id="checkMsg" class="muted">—</p>
      <p class="muted">أمثلة من عندك: <code>006b13f6-9a6b-4ea0-a42f-98b040f4d5d0</code>,
        <code>aae66022-26e2-403d-a3b8-e8d73555fafa</code>,
        <code>450d51a1-15b8-45e3-a818-d8c82f02eaeb</code>,
        <code>8135b5b2-0996-4e50-bd8c-6f3ddf9ef9b9</code>
      </p>
    </div>
  </div>

  <script>
    // مولد UUID v4 صحيح شكليًا
    function uuidv4() {
      const bytes = new Uint8Array(16);
      crypto.getRandomValues(bytes);
      bytes[6] = (bytes[6] & 0x0f) | 0x40; // version 4
      bytes[8] = (bytes[8] & 0x3f) | 0x80; // variant
      const hex = [...bytes].map(b => b.toString(16).padStart(2, '0')).join('');
      return `${hex.substr(0,8)}-${hex.substr(8,4)}-${hex.substr(12,4)}-${hex.substr(16,4)}-${hex.substr(20)}`;
    }

    // تحقق من الصيغة (Regex لِـ UUID v4)
    const uuidv4Regex = /^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;

    const outEl = document.getElementById('out');
    const totalEl = document.getElementById('total');
    const statusEl = document.getElementById('status');

    function setStatus(msg){ statusEl.textContent = msg; }

    function generate() {
      const count = Math.max(1, Math.min(10000, parseInt(document.getElementById('count').value || '1', 10)));
      const prefix = (document.getElementById('prefix').value || '').trim();
      const lines = [];
      for (let i = 0; i < count; i++) {
        let code = uuidv4();
        if (prefix) code = `${prefix}-${code}`;
        lines.push(code);
      }
      const existing = outEl.value.trim();
      outEl.value = existing ? (existing + "\n" + lines.join("\n")) : lines.join("\n");
      updateTotal();
      setStatus(`تم توليد ${count} كود`);
    }

    function updateTotal() {
      const n = outEl.value.trim() ? outEl.value.trim().split(/\r?\n/).length : 0;
      totalEl.textContent = n;
    }

    async function copyAll() {
      if (!outEl.value.trim()) return;
      await navigator.clipboard.writeText(outEl.value);
      setStatus('تم النسخ ✅');
    }

    function downloadTxt() {
      if (!outEl.value.trim()) return;
      const blob = new Blob([outEl.value], { type: 'text/plain' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      const ts = new Date().toISOString().replace(/[:.]/g,'-');
      a.download = `codes-${ts}.txt`;
      a.click();
      URL.revokeObjectURL(a.href);
      setStatus('تم التحميل ⬇️');
    }

    function clearOut() {
      outEl.value = '';
      updateTotal();
      setStatus('تم التفريغ');
    }

    function checkFormat() {
      const inp = document.getElementById('checkInput').value.trim();
      const msg = document.getElementById('checkMsg');
      if (!inp) { msg.textContent = '—'; return; }
      if (uuidv4Regex.test(inp)) {
        msg.textContent = '✅ الصيغة صحيحة (UUID v4)';
        msg.style.color = '#6ee7b7';
      } else {
        msg.textContent = '❌ الصيغة غير صحيحة';
        msg.style.color = '#fca5a5';
      }
    }

    document.getElementById('btnGen').addEventListener('click', generate);
    document.getElementById('btnCopy').addEventListener('click', copyAll);
    document.getElementById('btnDownload').addEventListener('click', downloadTxt);
    document.getElementById('btnClear').addEventListener('click', clearOut);
    document.getElementById('btnCheck').addEventListener('click', checkFormat);
    outEl.addEventListener('input', updateTotal);

    // أول تشغيل
    updateTotal(); setStatus('جاهز');
  </script>
</body>
  </html>
